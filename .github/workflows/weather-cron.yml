name: Weather Cron (Backup - Runs every 2 years)
on:
  # Runs once every 2 years on Jan 1st as backup
  schedule:
    - cron: '0 0 1 1 */2'  # Jan 1st every 2 years
  
  # Keep manual trigger for emergencies
  workflow_dispatch:
    inputs:
      reason:
        description: 'Reason for manual trigger'
        required: false
        default: 'Emergency backup'

jobs:
  trigger-backup:
    runs-on: ubuntu-latest
    if: github.event_name == 'workflow_dispatch'  # Only run manually
    
    steps:
      - name: ⚠️ EMERGENCY BACKUP MODE
        run: |
          echo "========================================"
          echo "⚠️  EMERGENCY BACKUP WEATHER CRON"
          echo "========================================"
          echo "Reason: ${{ github.event.inputs.reason }}"
          echo "Time: $(date)"
          echo "Note: cron-job.org should be handling regular notifications"
          echo "This is only for emergencies when cron-job.org fails"
          echo "========================================"
      
      - name: Trigger Weather API
        run: |
          curl -X POST "https://mangotango-backend.vercel.app/api/weather-cron" \
            -H "Content-Type: application/json" \
            -d '{"action":"cron-simulate","secret":"${{ secrets.CRON_SECRET }}"}'